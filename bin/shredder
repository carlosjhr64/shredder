#!/usr/bin/env ruby
require 'help_parser'

OPTIONS = HelpParser['2.0.200125', <<HELP]
Usage:
  shredder shred [:option] <shreds=FILENAME>+
  shredder sew [:option] <shreds=FILENAME>+
Option:
  --passphrase\tRelay passphrase from stding to stdout
Types:
  FILENAME  /^[[:print:]]+$/
# Examples:
#   shredder shred file.1 file.2 < file.txt
#   shredder sew file.1 file.2 > file.txt
HELP
if OPTIONS.shreds.length < 2
  $stderr.puts "Need at least 2 shreds"
  exit 64
end

require 'shredder/shredder'
require 'shredder/streams'
require 'shredder/stdio'

shredder = Shredder::StdIO.new(OPTIONS.shreds)
case OPTIONS[1]
when 'shred'
  shredder.shred
when 'sew'
  shredder.sew
end
